(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const m of i.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&n(m)}).observe(document,{childList:!0,subtree:!0});function o(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=o(r);fetch(r.href,i)}})();let ne={};AFRAME.registerComponent("move-to",{schema:{to:{type:"vec3"},duration:{type:"number",default:3e3}},init:function(){let e=this.el.getAttribute("position");this.startPos=new THREE.Vector3(e.x,e.y,e.z),this.endPos=new THREE.Vector3(this.data.to.x,this.data.to.y,this.data.to.z),this.elapsedTime=0,this.moving=!0},tick:function(e,t){if(!this.moving)return;this.elapsedTime+=t;let o=Math.min(this.elapsedTime/this.data.duration,1),n=new THREE.Vector3().lerpVectors(this.startPos,this.endPos,o);this.el.setAttribute("position",`${n.x} ${n.y} ${n.z}`),o>=1&&(this.moving=!1)}});ne.moveCameraVR=function(e,t,o){let n=document.querySelector("#rig");n.setAttribute("position",`${e.x} ${e.y} ${e.z}`),n.setAttribute("move-to",`to: ${t.x} ${t.y} ${t.z}; duration: ${o}`)};let re={};re.setupControllerClickHandler=function(){AFRAME.registerComponent("occulus-grab",{init:function(){let e=this.el,t=!1,o=null;this.onGrabStart=n=>{let r=n.target.components.raycaster;if(!r)return;let i=r.intersectedEls;i.length===0||i[0]!==e||(t=!0,o=n.target,e.setAttribute("dynamic-body","mass: 0"),e.setAttribute("grab",""),o.addEventListener("triggerup",this.onGrabEnd))},this.onGrabEnd=()=>{t&&(e.setAttribute("dynamic-body","mass: 1; restitution: 0.5; friction: 0.5"),e.removeAttribute("grab"),t=!1,o.removeEventListener("triggerup",this.onGrabEnd),o=null)},this.tick=function(){if(t&&o){let n=new THREE.Vector3,r=new THREE.Quaternion;o.object3D.getWorldPosition(n),o.object3D.getWorldQuaternion(r);let i=new THREE.Vector3(-.5,-1.8,-2.7);i.applyQuaternion(r);let m=n.clone().add(i);e.object3D.position.copy(m)}},e.sceneEl.addEventListener("triggerdown",this.onGrabStart)}})};window.addEventListener("load",function(){const e=document.getElementById("progress-bar");let t=0;const o=setInterval(function(){t>=100?(clearInterval(o),setTimeout(function(){document.getElementById("progress-bar-container").style.display="none";const n=document.querySelector("a-scene");n.style.display="block",setTimeout(function(){console.log("Déplacer le joueur en 8 secondes plus optimisation et fix loading screen et position 1.5 et corrextion loding screnn puis clique fix"),n.setAttribute("cursor","rayOrigin: mouse; "),ne.moveCameraVR({x:0,y:2.2,z:0},{x:1.237,y:1.5,z:-35},8e3)},500)},1e3)):(t++,e.style.width=t+"%")},10)});let L={};L.getAll=function(){return data};L.getTopUsers=async function(){return await(await fetch("https://mmi.unilim.fr/~savary23/Let_Him_Quizz/api/user?param=top10")).json()};L.addUser=async function(e,t){await fetch("https://mmi.unilim.fr/~savary23/Let_Him_Quizz/api/user?param=addUser&username="+e+"&score="+t)};let $={};const me=document.querySelector("#mainScene"),pe=await fetch("./src/components/leaderboard/template.html.inc"),fe=await pe.text();$.renderZone=async function(){let e=await L.getTopUsers();document.querySelector("#scoreboard")&&$.remove();const t=document.createElement("div");t.id="leaderboardZone";let o=fe;e.forEach((r,i)=>{o=o.replace(`{{user${i+1}}}`,`${i+1}. `+r.username).replace(`{{score${i+1}}}`,r.score)});for(let r=e.length;r<10;r++)o=o.replace(`{{user${r+1}}}`,"").replace(`{{score${r+1}}}`,"");t.innerHTML=o,t.querySelectorAll("#scoreboard").forEach(r=>{me.appendChild(r)})};$.remove=function(){document.querySelector("#scoreboard").remove()};let J={},O=[];J.getAll=function(){return data};J.getRandomPlace=async function(){let e;do e=await(await fetch("https://mmi.unilim.fr/~savary23/Let_Him_Quizz/api/place?param=random")).json();while(O.includes(e.id));let t=e.img,o=[e.reponse1,e.reponse2,e.reponse3,e.reponse4];return O.push(e.id),O.length>10&&O.shift(),{placeImage:t,propositions:o}};let Y=await fetch("./src/data/json/mcq.json");Y=await Y.json();let D={},z=[];D.getAll=function(){return Y};D.getRandomQuestion=async function(e){let t;do t=await(await fetch("https://mmi.unilim.fr/~savary23/Let_Him_Quizz/api/MCQ?difficulty="+e)).json();while(z.includes(t.id));let o=t.question,n=[t.reponse1,t.reponse2,t.reponse3,t.reponse4];return z.push(t.id),z.length>10&&z.shift(),{question:o,propositions:n}};const ye=await fetch("./src/components/money-counter/template.html.inc"),he=await ye.text(),Se=await fetch("./src/components/money-counter/money-template.html.inc"),we=await Se.text(),ie=document.querySelector("#mainScene");let u={},x=0;u.renderMoneyZone=function(){const e=document.createElement("div");e.id="moneyZone",e.innerHTML=he,e.querySelectorAll("#moneyZone").forEach(o=>{ie.appendChild(o)})};u.removeMoneyZone=function(){document.querySelector("#moneyZone").remove()};u.summonStack=function(e){for(let t=0;t<e;t++)setTimeout(()=>{const o=document.createElement("div");o.id="moneyStack";const n=Math.random()*1-5,r=Math.random()*1-41;o.innerHTML=we.replace("{{x}}",n).replace("{{z}}",r);const i=o.querySelector("#moneyStack");ie.appendChild(i),x=x+50,u.updateMoney(x),setTimeout(()=>{i.removeAttribute("dynamic-body"),i.setAttribute("static-body","")},3e3)},t*500)};u.updateMoney=async function(e){await document.querySelector("#moneyCount a-text").setAttribute("value",`$${e} `)};u.getMoney=function(){return x};u.setMoney=function(e){return x=e,u.updateMoney(x),x};u.removeMoney=function(e){const t=document.querySelectorAll("#moneyStack");x=x-50*e,u.updateMoney(x);for(let o=0;o<e;o++)t[o]&&setTimeout(()=>{t[o].remove()},o*100)};u.removeAllMoneyStack=function(){document.querySelectorAll("#moneyStack").forEach(t=>t.remove())};let v={};v.changeColor=function(e){document.querySelectorAll(".light").forEach(o=>{o.setAttribute("animation__color",{property:"light.color",to:e,dur:500,easing:"easeInOutQuad"})})};v.resetColor=function(){v.changeColor("#FFFFFF")};v.flashColor=function(e){v.changeColor(e),setTimeout(()=>{v.resetColor()},1e3)};const Q={correctAnswerSound:"./src/assets/audio/correct-choice.mp3",wrongAnswerSound:"./src/assets/audio/wrong-choice.mp3",tictacSound:"./src/assets/audio/tic-tac.mp3",tictacEndingSound:"./src/assets/audio/timer-ending.mp3",swooshSound:"./src/assets/audio/swoosh.mp3"};let y={};y.renderCorrectAnswer=function(){const e=document.getElementById("correctAnswerSound");e.src=Q.correctAnswerSound,e?e.play():console.error('Element with id "correctAnswerSound" not found.')};y.renderWrongAnswer=function(){const e=document.getElementById("wrongAnswerSound");e.src=Q.wrongAnswerSound,e?e.play():console.error('Element with id "wrongAnswerSound" not found.')};y.renderTictac=function(){const e=document.getElementById("tictacSound");e.src=Q.tictacSound,e?e.play():console.error('Element with id "tictacSound" not found.')};y.stopTictac=function(){const e=document.getElementById("tictacSound");e?e.pause():console.error('Element with id "tictacSound" not found.')};y.renderTictacEnding=function(){const e=document.getElementById("tictacEndingSound");e.src=Q.tictacEndingSound,e?e.play():console.error('Element with id "tictacEndingSound" not found.')};y.renderSwoosh=function(){const e=document.getElementById("swooshSound");e.src=Q.swooshSound,e?e.play():console.error('Element with id "swooshSound" not found.')};const ge=await fetch("src/components/ticking-away/template.html.inc");await ge.text();document.querySelector("#mainScene");document.querySelector("#timer");let g={};g.anchormanCheer=function(){document.querySelector("#anchorman").setAttribute("animation-mixer",{clip:"HumanArmature|Man_Clapping",loop:"once"}),setTimeout(()=>{g.anchormanIdle()},1800)};g.anchormanIdle=function(){document.querySelector("#anchorman").setAttribute("animation-mixer",{clip:"HumanArmature|Man_Idle"})};g.audienceCheer=function(){document.querySelectorAll(".audience-member").forEach(t=>{t.setAttribute("animation-mixer",{clip:"Armature|Jump",loop:"once"})}),setTimeout(()=>{g.audienceIdle()},1e3)};g.anchormanDeception=function(){document.querySelector("#anchorman").setAttribute("animation-mixer",{clip:"HumanArmature|Man_SwordSlash",loop:"once"}),setTimeout(()=>{g.anchormanIdle()},1e3)};g.keyPressed=function(e){e.setAttribute("animation",{property:"scale",to:"0.8 0.8 0.8",dur:100,dir:"alternate",loop:"2"}),setTimeout(()=>{e.removeAttribute("animation")},300)};const be=await fetch("./src/components/ticking-away/template.html.inc"),ve=await be.text(),Ae=document.querySelector("#mainScene");document.querySelector("#timer");let Z=0,A={},K=!1;A.renderQuizZone=function(){const e=document.createElement("div");e.id="quizZone",e.innerHTML=ve,e.querySelectorAll("#quizZone").forEach(n=>{Ae.appendChild(n)}),document.querySelectorAll(".answer").forEach(n=>{n.addEventListener("click",A.answerClicked)})};A.removeQuizZone=function(){const e=document.querySelector("#quizZone");e.setAttribute("animation",{property:"position",to:"0.99 -3 -36",dur:1e3,easing:"easeInOutQuad"}),setTimeout(()=>{e.remove()},1e3)};A.newQuestion=async function(){K=!1,document.querySelectorAll(".answer a-box").forEach(n=>{n.setAttribute("color","#ff0000")});let e=await D.getRandomQuestion("medium");document.querySelector("#question a-text").setAttribute("value",e.question);let t=e.propositions.slice();for(let n=t.length-1;n>0;n--){const r=Math.floor(Math.random()*(n+1));[t[n],t[r]]=[t[r],t[n]]}document.querySelectorAll(".answer a-box").forEach(n=>{n.getAttribute("id")==="good answer"&&n.removeAttribute("id")}),document.querySelector("#answer1 a-text").setAttribute("value",t[0]),document.querySelector("#answer2 a-text").setAttribute("value",t[1]),document.querySelector("#answer3 a-text").setAttribute("value",t[2]),document.querySelector("#answer4 a-text").setAttribute("value",t[3]);const o=t.indexOf(e.propositions[0]);document.querySelector(`#answer${o+1} a-box`).setAttribute("id","good answer")};A.answerClicked=function(e){if(K)return;document.querySelectorAll(".answer a-box").forEach(o=>{o.getAttribute("id")==="good answer"?o.setAttribute("color","#00ff00"):o.setAttribute("color","#ff0000")});const t=document.querySelector(`#${e.target.parentElement.id} a-box`);t.removeAttribute("animation"),t.setAttribute("animation","property: scale; to: 1.1 1.1 1.1; dur: 100; loop: 2; dir: alternate"),t.id==="good answer"?(v.flashColor("#00ff00"),g.anchormanCheer(),g.audienceCheer(),y.renderCorrectAnswer(),setTimeout(()=>{A.newQuestion()},500),u.summonStack(2)):(v.flashColor("#ff0000"),g.anchormanDeception(),y.renderWrongAnswer(),setTimeout(()=>{A.newQuestion()},2e3)),K=!0};A.startTimer=function(){Z=0;let e=30;y.renderTictac(),document.querySelector("#timer a-text").setAttribute("value",e-Z);const t=setInterval(()=>{Z++,document.querySelector("#timer a-text").setAttribute("value",e-Z),Z===e&&(clearInterval(t),c.nextRound(),y.stopTictac(),y.renderTictacEnding())},1e3)};const qe=await fetch("./src/components/find-the-place/template.html.inc"),Ee=await qe.text(),se=document.querySelector("#mainScene");let M=0,P=0,_=!1,w={};w.renderPropositionsZone=function(){P>=3&&(P=0);const e=document.createElement("div");e.id="propositionsZone",e.innerHTML=Ee,e.querySelectorAll("#propositionsZone").forEach(n=>{se.appendChild(n)}),document.querySelectorAll(".answer").forEach(n=>{n.addEventListener("click",w.answerClicked)})};w.removeQuizZone=function(){const e=document.querySelector("#propositionsZone");e.setAttribute("animation",{property:"position",to:"0.99 -3 -36",dur:1e3,easing:"easeInOutQuad"}),setTimeout(()=>{e.remove()},800)};w.renderQuestion=async function(){let e=await J.getRandomPlace();const t=document.createElement("a-sky");t.setAttribute("class","interactable"),t.setAttribute("position","1.237 3 -35.03326"),t.setAttribute("id","360Sky"),t.setAttribute("radius","2"),t.setAttribute("src",`./src/assets/360locations/${e.placeImage}`),t.setAttribute("animation__enter","property: position; from: 1.237 3 -40; to: 1.237 3 -35.03326; dur: 3000; easing: easeInOutQuad"),t.setAttribute("animation__scale","property: scale; from: 0.1 0.1 -0.1; to: 1 1 -1; dur: 3000; easing: easeInOutQuad"),t.setAttribute("animation__exit","property: position; to: 1.237 -10 -35.03326; delay:10000; dur: 3000; easing: easeInOutQuad"),se.appendChild(t);let o=e.propositions.slice();for(let r=o.length-1;r>0;r--){const i=Math.floor(Math.random()*(r+1));[o[r],o[i]]=[o[i],o[r]]}document.querySelector("#answer1 a-text").setAttribute("value",o[0]),document.querySelector("#answer2 a-text").setAttribute("value",o[1]),document.querySelector("#answer3 a-text").setAttribute("value",o[2]),document.querySelector("#answer4 a-text").setAttribute("value",o[3]);const n=o.indexOf(e.propositions[0]);document.querySelector(`#answer${n+1} a-box`).setAttribute("id","good answer")};w.answerClicked=function(e){if(_)return;document.querySelectorAll(".answer a-box").forEach(o=>{o.getAttribute("id")==="good answer"?o.setAttribute("color","#00ff00"):o.setAttribute("color","#ff0000")});const t=document.querySelector(`#${e.target.parentElement.id} a-box`);t.removeAttribute("animation"),t.setAttribute("animation","property: scale; to: 1.1 1.1 1.1; dur: 100; loop: 2; dir: alternate"),t.id==="good answer"?(y.renderCorrectAnswer(),v.flashColor("#00ff00"),g.anchormanCheer(),g.audienceCheer(),setTimeout(()=>{w.newRound()},1e3),u.summonStack(6)):(y.renderWrongAnswer(),v.flashColor("#ff0000"),g.anchormanDeception(),setTimeout(()=>{w.newRound()},1e3)),_=!0};w.startTimer=function(){M=0,document.querySelector("#timer a-text").setAttribute("value",M),setInterval(()=>{M++,document.querySelector("#timer a-text").setAttribute("value",M),M===7&&w.removeQuizZone()},1e3)};w.newRound=function(){P++,P===3?(_=!1,c.nextRound()):(document.getElementById("360Sky").remove(),w.removeQuizZone(),setTimeout(()=>{w.renderPropositionsZone(),w.renderQuestion(),_=!1},1200))};const xe=await fetch("./src/components/sorrynotsorich/template.html.inc"),Te=await xe.text(),Ce=await fetch("./src/components/sorrynotsorich/money-template.html.inc");await Ce.text();const ke=document.querySelector("#mainScene");let q={},C=0,X=0;q.renderQuizZone=function(){const e=document.createElement("div");for(e.id="sorryNotSoRichDiv",e.innerHTML=Te,X=0;e.firstChild;)ke.appendChild(e.firstChild);q.newQuestion()};q.newQuestion=async function(){if(X++,X===4){setTimeout(()=>{c.nextRound()},1500);return}let e=await D.getRandomQuestion("hard");document.querySelectorAll(".answer a-box").forEach(n=>{n.setAttribute("color","#3246E7")}),C=0,document.querySelector("#question a-text").setAttribute("value",e.question);let t=e.propositions.slice();for(let n=t.length-1;n>0;n--){const r=Math.floor(Math.random()*(n+1));[t[n],t[r]]=[t[r],t[n]]}document.querySelectorAll(".good-answer").forEach(n=>{n.classList.remove("good-answer")}),document.querySelectorAll(".good-answerbox").forEach(n=>{n.classList.remove("good-answerbox")}),document.querySelector("#answer1 a-text").setAttribute("value",t[0]),document.querySelector("#answer2 a-text").setAttribute("value",t[1]),document.querySelector("#answer3 a-text").setAttribute("value",t[2]),document.querySelector("#answer4 a-text").setAttribute("value",t[3]);const o=t.indexOf(e.propositions[0]);document.querySelector(`#bet${o+1}`).classList.add("good-answer"),document.querySelector(`#answer${o+1}`).classList.add("good-answerbox"),q.calculateMoney()};q.updateAnswerColors=function(){[document.querySelector("#answer1 a-box"),document.querySelector("#answer2 a-box"),document.querySelector("#answer3 a-box"),document.querySelector("#answer4 a-box")].forEach(t=>{t.parentElement.classList.contains("good-answerbox")?t.setAttribute("color","green"):t.setAttribute("color","red")})};q.calculateMoney=function(){let e=u.getMoney();const t=[document.querySelector("#bet1"),document.querySelector("#bet2"),document.querySelector("#bet3"),document.querySelector("#bet4")],o=[document.querySelector("#plus1"),document.querySelector("#plus2"),document.querySelector("#plus3"),document.querySelector("#plus4")],n=[document.querySelector("#minus1"),document.querySelector("#minus2"),document.querySelector("#minus3"),document.querySelector("#minus4")],r=[document.querySelector("#trap1"),document.querySelector("#trap2"),document.querySelector("#trap3"),document.querySelector("#trap4")];t.forEach(s=>s.setAttribute("value","$0"));const i=()=>{C=t.reduce((s,a)=>s+parseInt(a.getAttribute("value").replace("$","")),0),u.updateMoney(e-C),C===e&&u.removeAllMoneyStack()},m=()=>{const s=C===e;o.forEach(a=>a.setAttribute("visible",!s)),document.querySelector("#validButton").setAttribute("visible",s),document.querySelector("#validButton a-box").classList.toggle("interactable",s)},d=s=>C+s<=e,p=s=>{let a=parseInt(t[s].getAttribute("value").replace("$",""));d(100)&&(t[s].setAttribute("value",`$${a+100}`),u.removeMoney(2),j(s),i(),m(),n[s].setAttribute("visible",!0))},h=s=>{let a=parseInt(t[s].getAttribute("value").replace("$",""));a>0&&(t[s].setAttribute("value",`$${a-100}`),u.summonStack(2),N(s),i(),m(),document.querySelector("#validButton a-box").classList.remove("interactable")),parseInt(t[s].getAttribute("value").replace("$",""))===0&&n[s].setAttribute("visible",!1)},k=()=>{let s=document.querySelector(".good-answer");console.log("correctAnswerBox: "+s);let a=parseInt(s.getAttribute("value").replace("$","")),l=C/2;a>l&&(y.renderCorrectAnswer(),v.changeColor("green")),a<l&&(y.renderWrongAnswer(),v.changeColor("red")),a===l&&console.log("Tu perds autant d'argent que tu en conserves"),e=u.setMoney(a),setTimeout(()=>{V()},1500),q.updateAnswerColors();for(let b=1;b<=4;b++)y.renderSwoosh(),document.querySelector(`#bet${b}`).classList.contains("good-answer")||(document.querySelector(`#trap${b}`).removeAttribute("animation__rotation","property: rotation; to: 0 0 0; loop: false; dur: 1000"),document.querySelector(`#trap${b}`).setAttribute("animation__rotation","property: rotation; to: 90 0 0; loop: false; dur: 1000"));t.forEach(b=>b.setAttribute("value","$0")),setTimeout(()=>{if(a===0)console.log("You lost all your money!"),q.removeQuizZone(),u.removeAllMoneyStack();else{m(),i(),q.newQuestion();for(let b=1;b<=4;b++)document.querySelector(`#bet${b}`).classList.contains("good-answer")||(document.querySelector(`#trap${b}`).removeAttribute("animation__rotation","property: rotation; to: 90 0 0; loop: false; dur: 1000"),document.querySelector(`#trap${b}`).setAttribute("animation__rotation","property: rotation; to: 0 0 0; loop: false; dur: 1000"))}},2e3)},j=s=>{const a=r[s],l=document.createElement("a-entity");l.setAttribute("gltf-model","./src/assets/modele3d/money.glb");const b=a.querySelectorAll(".moneyStack").length,ue=Math.floor(b/5),le=b%5*.1,de=ue*.2;l.setAttribute("position",`${de} ${le} 0.75`),l.setAttribute("scale","0.4 0.4 0.4"),l.classList.add("moneyStack"),a.appendChild(l)},N=s=>{const a=r[s],l=a.querySelectorAll(".moneyStack");l.length>0&&a.removeChild(l[l.length-1])},V=()=>{r.forEach(s=>{s.querySelectorAll(".moneyStack").forEach(l=>s.removeChild(l))})},U=()=>{o.forEach((s,a)=>{s.addEventListener("click",()=>p(a))}),n.forEach((s,a)=>{s.addEventListener("click",()=>h(a))}),document.querySelector("#validButton").addEventListener("click",k)};o.forEach((s,a)=>{const l=s.cloneNode(!0);s.parentNode.replaceChild(l,s),o[a]=l}),n.forEach((s,a)=>{const l=s.cloneNode(!0);s.parentNode.replaceChild(l,s),n[a]=l}),document.querySelector("#validButton").replaceWith(document.querySelector("#validButton").cloneNode(!0)),n.forEach(s=>s.setAttribute("visible",!1)),document.querySelector("#validButton").setAttribute("visible",!1),document.querySelector("#validButton a-box").classList.remove("interactable"),U()};q.removeQuizZone=function(){const e=document.querySelector("#sorrynotsorich-container");setTimeout(()=>{e.remove()},800),e.setAttribute("animation",{property:"position",to:"0.99 -3 -36",dur:1e3,easing:"easeInOutQuad"})};let ee={};ee.getAll=function(){return data};ee.getRandomSortItOut=async function(){let e=[],t;do t=await(await fetch("https://mmi.unilim.fr/~savary23/Let_Him_Quizz/api/sort?difficulty=hard")).json();while(e.includes(t.id));return e.push(t.id),e.length>3&&e.shift(),{difficulty:t.difficulty,id:t.id,question:t.question,responses:[R(t.reponse1),R(t.reponse2),R(t.reponse3),R(t.reponse4)]}};function R(e){let t=e.split("§");return{answer:t[0].trim(),solution:t[1]?t[1].trim():null}}let f={},H=!1,B=1;const oe=3;f.resetGameState=function(){H=!1,console.log("Game state reset. Rounds: "+B),v.resetColor()};async function Ie(){const e=await fetch("./src/components/sort-it-out/template.html.inc");if(!e.ok)throw new Error("Failed to load template");return await e.text()}const $e=document.querySelector("#mainScene");f.renderSortItOutZone=async function(){f.resetGameState();let e=await ee.getRandomSortItOut();const t=await Ie(),o=document.createElement("a-entity");o.id="sortItOutZone",o.innerHTML=t,$e.appendChild(o);function n(d){for(let p=d.length-1;p>0;p--){const h=Math.floor(Math.random()*(p+1));[d[p],d[h]]=[d[h],d[p]]}}e.responses.forEach((d,p)=>{const h=document.querySelector(`#hollowBox${p+1}`);h&&h.setAttribute("data-valeur",d.answer)});const r=[...e.responses];n(r),r.forEach((d,p)=>{const h=document.querySelector(`#movableBox${p+1}`),k=document.querySelector(`#answer${p+1}`);h&&h.setAttribute("data-valeur",d.answer),k&&k.setAttribute("value",d.answer)}),document.querySelector("#question").setAttribute("value",e.question);const m=document.querySelector("#validButton");m&&m.addEventListener("click",()=>{f.CheckIfInside(e),console.log("Check if inside")}),document.querySelectorAll("#movableBox1, #movableBox2, #movableBox3, #movableBox4").forEach(d=>{d.setAttribute("draggable",""),d.setAttribute("occulus-grab","")}),f.setupDraggables()};f.removeSortItOutZone=function(){const e=document.querySelector("#sortItOutZone");e&&e.remove(),v.resetColor()};f.setupDraggables=function(){AFRAME.registerComponent("draggable",{init:function(){const e=this.el;let t=!1;e.addEventListener("mousedown",()=>{t=!0,e.setAttribute("dynamic-body","mass: 0")}),document.addEventListener("mousemove",o=>{if(t){const r=document.querySelector("a-scene").components.raycaster.getIntersection(e);if(r){const i=r.point;e.setAttribute("position",`${i.x} ${i.y} ${e.getAttribute("position").z}`)}}}),document.addEventListener("mouseup",()=>{t&&(t=!1,e.setAttribute("dynamic-body","mass: 5"))})}})};f.resetCounter=function(){B=1};f.resetAndRenderZone=function(){B<oe?(B++,console.log("Starting round "+B),f.removeSortItOutZone(),f.renderSortItOutZone()):(console.log("Game finished after "+oe+" rounds."),f.removeSortItOutZone(),c.nextRound())};f.CheckIfInside=function(e){if(H)return;const t=document.querySelectorAll("[id^='movableBox']"),o=document.querySelectorAll("[id^='hollowBox']");let n=!0;t.forEach(r=>{const i=r.object3D.position;let m=!1;o.forEach(d=>{const p=d.object3D.position,h=.8,k=p.x-h/2,j=p.x+h/2,N=p.y-h/2,V=p.y+h/2,U=p.z-h/2,s=p.z+h/2,a=r.getAttribute("data-valeur"),l=d.getAttribute("data-valeur");i.x>=k&&i.x<=j&&i.y>=N&&i.y<=V&&i.z>=U&&i.z<=s&&a===l&&(m=!0)}),m||(n=!1)}),n?(v.changeColor("#A3E447"),y.renderCorrectAnswer(),g.anchormanCheer(),H=!0,u.summonStack(2),setTimeout(()=>{f.resetAndRenderZone()},2e3)):(v.changeColor("#FF662F"),y.renderWrongAnswer(),g.anchormanDeception(),e.responses.forEach((r,i)=>{const m=document.querySelector(`#answer${i+1}`),d=document.querySelector(`#boxanswer${i+1}`);m&&(d.setAttribute("color","#FF662F"),m.setAttribute("value",""),m.setAttribute("value",i+1+") "+r.answer))}),H=!0,setTimeout(()=>{f.resetAndRenderZone()},6e3))};const Ze=await fetch("./src/components/keyboard/template.html.inc"),Me=await Ze.text(),Be=await fetch("./src/components/keyboard/templateInput.html.inc"),Le=await Be.text(),ae=document.querySelector("#mainScene");let E={},I="";E.render=function(){const e=document.createElement("a-entity");e.id="keyboard",e.innerHTML=Me,ae.appendChild(e),e.addEventListener("click",E.keyClicked),E.renderInput()};E.keyClicked=function(e){const t=e.target.querySelector("a-text").getAttribute("value");if(g.keyPressed(e.target),t==="Del")I=I.slice(0,-1);else if(t==="OK")L.addUser(I,u.getMoney()),E.remove();else{if(I.length>=20)return;I+=t}E.updateInput()};E.renderInput=function(){const e=document.createElement("a-entity");e.id="input",e.innerHTML=Le,ae.appendChild(e),E.updateInput()};E.updateInput=function(){document.querySelector("#input-text").setAttribute("value",I+"_")};E.remove=function(){const e=document.querySelector("#keyboard");e.setAttribute("animation",{property:"position",to:"0.99 -3 -36",dur:1e3,easing:"easeInOutQuad"}),document.querySelector("#input").setAttribute("animation",{property:"position",to:"0.99 -3 -36",dur:1e3,easing:"easeInOutQuad"}),c.removeEndingScreen(),setTimeout(()=>{e.parentNode.removeChild(e);const o=document.querySelector("#input");o.parentNode.removeChild(o),c.startGame()},1e3)};const Qe=await fetch("./src/components/rounds/template.html.inc"),Oe=await Qe.text(),ze=await fetch("./src/components/rounds/templateExplanation.html.inc"),Re=await ze.text(),Fe=await fetch("./src/components/rounds/templateMenu.html.inc"),He=await Fe.text(),Pe=await fetch("./src/components/rounds/templateEnding.html.inc"),_e=await Pe.text(),G=document.querySelector("#mainScene");let c={},te=!1,F=["TickingAway","FindThePlace","SortItOut","SorryNotSoRich"],S="",T=1;c.startGame=async function(){u.setMoney(0),T=1,u.renderMoneyZone(),$.renderZone(),document.querySelector("#anchorman").addEventListener("click",c.clickOnAnchorman),c.renderMenu()};c.nextRound=async function(){if(T>F.length){setTimeout(()=>{c.endGame()},1e3);return}console.log("Round: ",T," - ",F[T-1]),T!=1&&(S==="FindThePlace"?w.removeQuizZone():S==="TickingAway"?A.removeQuizZone():S==="SortItOut"?f.removeSortItOutZone():S==="SorryNotSoRich"&&q.removeQuizZone()),setTimeout(()=>{S=F[T-1]},500),c.renderExplanationZone(De[F[T-1]]);const e=async()=>{te?setTimeout(e,100):(setTimeout(()=>{S==="FindThePlace"?(w.renderPropositionsZone(),w.renderQuestion()):S==="TickingAway"?(A.renderQuizZone(),A.newQuestion(),A.startTimer()):S==="SortItOut"?(f.resetCounter(),f.renderSortItOutZone()):S==="SorryNotSoRich"&&q.renderQuizZone()},500),T++)};e()};c.endGame=function(){S==="FindThePlace"?w.removeQuizZone():S==="TickingAway"?A.removeQuizZone():S==="SortItOut"?f.removeSortItOutZone():S==="SorryNotSoRich"&&q.removeQuizZone(),setTimeout(()=>{E.render(),u.removeMoneyZone();const e=document.createElement("a-entity");e.id="endingScreen",e.innerHTML=_e.replace("{{final-score}}",u.getMoney()),G.appendChild(e)},1e3)};c.explainGame=function(e){const t=document.createElement("a-entity");t.id="explanationZone",t.innerHTML=Oe.replace("{{message}}",e),console.log("Explanation: ",t),G.appendChild(t),setTimeout(()=>{c.removeExplanation()},3e3)};c.removeEndingScreen=function(){const e=document.querySelector("#endingScreen");e.setAttribute("animation",{property:"position",to:"0 -6 0",dur:600,easing:"easeInOutQuad"}),setTimeout(()=>{e.remove(),$.remove()},700)};c.removeExplanation=function(){explanationZone.setAttribute("animation",{property:"position",to:"0 -6 0",dur:600,easing:"easeInOutQuad"}),setTimeout(()=>{document.querySelector("#explanationZone").remove()},700)};let W=!1;c.clickOnAnchorman=function(){W||(S==="FindThePlace"?c.explainGame("Find the correct place"):S==="TickingAway"?c.explainGame("Answer the questions before the timer runs out"):S==="SortItOut"?c.explainGame("Sort the answers in the correct order"):S==="SorryNotSoRich"&&c.explainGame("Bet on the correct answer but save some money!"),W=!0,setTimeout(()=>{c.removeExplanation(),setTimeout(()=>{W=!1},1e3)},5e3))};const De={FindThePlace:`Find the place 
 In each round, you will be dropped in a place in the world. 
 Then, you will have to guess between 4 propositions where you were. 
 Look for signs, driving side, flags and other clues ! 
 Each good answer gives you 300$`,TickingAway:`Ticking away 
 You will have 30 seconds to answer as much questions as you can. 
 But be careful, a wrong answer will make you lose some time! 
 Each good answer gives you 100$`,SortItOut:`Sort it out 
 Sort the answers in the crescent order by moving the colored cubes in the right box. 
 Then, lock your answer and cross your fingers ! 
 Each good answer gives you 200$`,SorryNotSoRich:`Sorry not so rich 
 Bet on the correct answer by spreading your money between the 4 propositions. 
 But be careful, you will lose the money you bet on wrong answers !`};c.renderExplanationZone=function(e){te=!0;const t=document.createElement("a-entity");t.id="explanationZone",t.innerHTML=Re.replace("{{explanation}}",e),G.appendChild(t),document.querySelector("#validButton-explanation").addEventListener("click",c.removeExplanationZone)};c.removeExplanationZone=function(){te=!1,console.log("Remove explanation zone");const e=document.querySelector("#explanationZone");e.setAttribute("animation",{property:"position",to:"0 -6 0",dur:600,easing:"easeInOutQuad"}),setTimeout(()=>{e.remove()},700)};c.renderMenu=function(){const e=document.createElement("a-entity");e.id="menuZone",e.innerHTML=He,G.appendChild(e),document.querySelector("#startButton-menu").addEventListener("click",c.removeMenu)};c.removeMenu=function(){const e=document.querySelector("#menuZone");e.setAttribute("animation",{property:"position",to:"0 -6 0",dur:600,easing:"easeInOutQuad"}),setTimeout(()=>{e.remove(),c.nextRound()},700)};console.log("Leaderboard imported");console.log("Rounds imported");console.log("VR imported");re.setupControllerClickHandler();console.log("Controller click handler set up");function ce(){console.log("Update"),requestAnimationFrame(ce)}ce();console.log("Update started");setTimeout(()=>{console.log("Games reimported"),c.startGame(),$.renderZone()},5e3);
